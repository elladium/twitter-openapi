openapi: 3.0.3
info:
  title: Twitter OpenAPI
  version: 0.0.1

paths: {}
components:
  schemas:
    ContentUnion:
      oneOf:
        - $ref: "#/components/schemas/TimelineTimelineItem"
        - $ref: "#/components/schemas/TimelineTimelineModule"
        - $ref: "#/components/schemas/TimelineTimelineCursor"
      discriminator:
        propertyName: entryType
        mapping": # deprecated
          TimelineTimelineItem: "#/components/schemas/TimelineTimelineItem"
          TimelineTimelineModule: "#/components/schemas/TimelineTimelineModule"
          TimelineTimelineCursor: "#/components/schemas/TimelineTimelineCursor"

    ContentEntryType:
      type: string
      enum:
        [TimelineTimelineItem, TimelineTimelineCursor, TimelineTimelineModule]

    CursorType:
      type: string
      enum: [Top, Bottom, ShowMore, ShowMoreThreads, Gap, ShowMoreThreadsPrompt] # Gap???

    TimelineTimelineItem:
      required:
        - "__typename"
        - "entryType"
        - "itemContent"
      properties:
        __typename:
          $ref: "./typename.yaml#/components/schemas/TypeName" # TimelineTimelineItem
        entryType:
          $ref: "#/components/schemas/ContentEntryType" # TimelineTimelineItem
        itemContent:
          $ref: "#/components/schemas/ItemContentUnion"
        clientEventInfo:
          $ref: "#/components/schemas/ClientEventInfo"
        feedbackInfo:
          type: object
          additionalProperties: true # todo

    TimelineTimelineModule:
      required:
        - "__typename"
        - "entryType"
        - "displayType"
        # - "items"
        - "clientEventInfo"
      properties:
        __typename:
          type: string
          $ref: "./typename.yaml#/components/schemas/TypeName" # TimelineTimelineModule
        entryType:
          $ref: "#/components/schemas/ContentEntryType" # TimelineTimelineCursor
        displayType:
          $ref: "#/components/schemas/DisplayType"
        items:
          type: array
          items:
            $ref: "#/components/schemas/ModuleItem"
        footer:
          type: object
          additionalProperties: true # todo
        header:
          type: object
          additionalProperties: true # todo
        clientEventInfo:
          $ref: "#/components/schemas/ClientEventInfo"
        metadata:
          type: object
          additionalProperties: true # todo
        feedbackInfo:
          $ref: "#/components/schemas/FeedbackInfo"

    TimelineTimelineCursor:
      required:
        - "__typename"
        - "cursorType"
        - "value"
      properties:
        __typename:
          $ref: "./typename.yaml#/components/schemas/TypeName" # TimelineTimelineCursor
        entryType:
          $ref: "#/components/schemas/ContentEntryType" # null | TimelineTimelineCursor
        itemType:
          $ref: "#/components/schemas/ContentEntryType" # null | TimelineTimelineCursor
        cursorType:
          $ref: "#/components/schemas/CursorType"
        value:
          type: string
        stopOnEmptyResponse:
          type: boolean
        displayTreatment:
          $ref: "#/components/schemas/DisplayTreatment"

    DisplayTreatment:
      type: object
      required:
        - "actionText"
      properties:
        actionText:
          type: string
        labelText:
          type: string

    # ================= Module =================

    DisplayType:
      type: string
      enum:
        - Vertical
        - VerticalConversation
        - VerticalGrid
        - Carousel

    ModuleItem:
      required:
        - "entryId"
        - "item"
      properties:
        entryId:
          type: string
          pattern: "^(([a-z]+|[0-9]+|[0-9a-f]+)(-|$))+"
        item:
          $ref: "#/components/schemas/ModuleEntry"
        dispensable:
          type: boolean

    ModuleEntry:
      required:
        - "itemContent"
      properties:
        clientEventInfo:
          $ref: "#/components/schemas/ClientEventInfo"
        itemContent:
          $ref: "#/components/schemas/ItemContentUnion"
        feedbackInfo:
          $ref: "#/components/schemas/FeedbackInfo"

    FeedbackInfo:
      required:
        - "feedbackType"
      properties:
        feedbackKeys:
          type: array
          items:
            type: string
        clientEventInfo:
          $ref: "#/components/schemas/ClientEventInfo"

    # ================= ContentItem =================

    ItemContentUnion:
      oneOf:
        - $ref: "#/components/schemas/TimelineTweet"
        - $ref: "#/components/schemas/TimelineTimelineCursor"
        - $ref: "#/components/schemas/TimelineUser"
        - $ref: "#/components/schemas/TimelinePrompt"
        - $ref: "#/components/schemas/TimelineMessagePrompt"
        - $ref: "#/components/schemas/TimelineCommunity"
        - $ref: "#/components/schemas/TimelineTombstone"
        - $ref: "#/components/schemas/TimelineTrend"

      discriminator:
        propertyName: __typename
        mapping": # deprecated
          TimelineTweet: "#/components/schemas/TimelineTweet"
          TimelineTimelineCursor: "#/components/schemas/TimelineTimelineCursor"
          TimelineUser: "#/components/schemas/TimelineUser"
          TimelinePrompt: "#/components/schemas/TimelinePrompt"
          TimelineMessagePrompt: "#/components/schemas/TimelineMessagePrompt"
          TimelineCommunity: "#/components/schemas/TimelineCommunity"
          TimelineTombstone: "#/components/schemas/TimelineTombstone"
          TimelineTrend: "#/components/schemas/TimelineTrend"

    ContentItemType:
      type: string
      enum:
        [
          TimelineTweet,
          TimelineTimelineCursor,
          TimelineUser,
          TimelinePrompt,
          TimelineMessagePrompt,
          TimelineCommunity,
          TimelineTombstone,
        ]

    TimelineTweet:
      required:
        - "__typename"
        - "itemType"
        - "tweetDisplayType"
        - "tweet_results"
      properties:
        __typename:
          $ref: "./typename.yaml#/components/schemas/TypeName" # TimelineTweet
        itemType:
          $ref: "#/components/schemas/ContentItemType" # TimelineTweet
        tweetDisplayType:
          type: string
          enum: [Tweet, SelfThread, MediaGrid, CondensedTweet]
        tweet_results:
          $ref: "#/components/schemas/ItemResult"
        socialContext:
          $ref: "#/components/schemas/SocialContextUnion"
        promotedMetadata:
          type: object
          additionalProperties: true # todo
        highlights:
          $ref: "#/components/schemas/Highlight"
        hasModeratedReplies:
          type: boolean

    TimelineUser:
      required:
        - "__typename"
        - "itemType"
        - "userDisplayType"
        - "user_results"
      properties:
        __typename:
          $ref: "./typename.yaml#/components/schemas/TypeName" # TimelineUser
        itemType:
          $ref: "#/components/schemas/ContentItemType" # TimelineUser
        socialContext:
          $ref: "#/components/schemas/SocialContextUnion"
        userDisplayType:
          type: string
          enum: [User, UserDetailed, SubscribableUser]
        user_results:
          $ref: "./user.yaml#/components/schemas/UserResults"

    ItemResult:
      properties:
        __typename:
          $ref: "./typename.yaml#/components/schemas/TypeName" # null | TimelineTweet | TweetUnavailable
        result:
          $ref: "./tweet.yaml#/components/schemas/TweetUnion"

    SocialContextUnion:
      oneOf:
        - $ref: "#/components/schemas/TimelineGeneralContext"
        - $ref: "#/components/schemas/TimelineTopicContext"
      discriminator:
        propertyName: type
        mapping": # deprecated
          TimelineGeneralContext: "#/components/schemas/TimelineGeneralContext"
          TimelineTopicContext: "#/components/schemas/TimelineTopicContext"

    SocialContextUnionType:
      type: string
      enum:
        - TimelineGeneralContext
        - TimelineTopicContext

    TimelineGeneralContext:
      type: object
      properties:
        type:
          $ref: "#/components/schemas/SocialContextUnionType"
        contextType:
          type: string # enum
          enum:
            - "Follow"
            - "Pin"
            - "Like"
            - "Location"
            - "Sparkle"
            - "Conversation"
            - "List"
            - "Community"
        text:
          type: string
        landingUrl:
          $ref: "#/components/schemas/SocialContextLandingUrl"

    TimelineTopicContext:
      type: object
      properties:
        type:
          $ref: "#/components/schemas/SocialContextUnionType"
        topic:
          $ref: "#/components/schemas/TopicContext"
        functionalityType:
          type: string
          enum: ["Basic"]

    TopicContext:
      type: object
      properties:
        id:
          type: string
        topic_id:
          type: string
        name:
          type: string
        description:
          type: string
        icon_url:
          type: string
          format: uri
        following:
          type: boolean
        not_interested:
          type: boolean

    SocialContextLandingUrl:
      type: object
      properties:
        urlType:
          type: string # enum
          enum: ["DeepLink", "UrtEndpoint", "ExternalUrl"]
        url:
          type: string # twitter://user?id=900282258736545792
          format: uri
        urtEndpointOptions:
          $ref: "#/components/schemas/UrtEndpointOptions"

    UrtEndpointOptions:
      type: object
      required:
        - "title"
        - "requestParams"
      properties:
        title:
          type: string
        requestParams:
          type: array
          items:
            $ref: "#/components/schemas/UrtEndpointRequestParams"

    UrtEndpointRequestParams:
      type: object
      required:
        - "key"
        - "value"
      properties:
        key:
          type: string
        value:
          type: string

    Highlight:
      type: object
      required:
        - "textHighlights"
      properties:
        textHighlights:
          type: array
          items:
            $ref: "#/components/schemas/TextHighlight"

    TextHighlight:
      type: object
      required:
        - "startIndex"
        - "endIndex"
      properties:
        startIndex:
          type: integer
        endIndex:
          type: integer

    TimelinePrompt:
      properties:
        __typename:
          $ref: "./typename.yaml#/components/schemas/TypeName" # TimelinePrompt
      additionalProperties: true # todo

    TimelineMessagePrompt:
      properties:
        __typename:
          $ref: "./typename.yaml#/components/schemas/TypeName" # TimelineMessagePrompt
      additionalProperties: true # todo

    TimelineCommunity:
      properties:
        __typename:
          $ref: "./typename.yaml#/components/schemas/TypeName" # TimelineCommunity
      additionalProperties: true # todo

    ClientEventInfo:
      properties:
        component:
          # enum half_cover
          type: string
        element:
          type: string
          # august-2023-privacy-prompt-candidate
          # pattern: "(([a-z]+|[0-9]+|[0-9a-f]+)(-|$))+"
          # pattern: "^(january|february|march|april|may|june|july|august|september|october|november|december)-[0-9]{4}-([a-z]-)+[a-z]+$"
        details:
          type: object
          additionalProperties: true # todo

    TimelineTombstone:
      properties:
        __typename:
          $ref: "./typename.yaml#/components/schemas/TypeName" # TimelineTombstone
        itemType:
          $ref: "#/components/schemas/ContentItemType" # TimelineTombstone
        tombstoneDisplayType:
          type: string
          enum: [Inline]
        tombstoneInfo:
          $ref: "#/components/schemas/TombstoneInfo"

    TombstoneInfo:
      type: object
      properties:
        text:
          type: string
        richText:
          $ref: "#/components/schemas/TombstoneRichText"

    TombstoneRichText:
      type: object
      properties:
        rtl:
          type: boolean
        text:
          type: string
        entities:
          type: array
          items:
            $ref: "#/components/schemas/TombstoneEntity"

    TombstoneEntity:
      type: object
      properties:
        fromIndex:
          type: integer
        toIndex:
          type: integer
        ref:
          $ref: "#/components/schemas/TombstoneRef"

    TombstoneRef:
      type: object
      properties:
        type:
          type: string
          enum: [TimelineUrl]
        url:
          type: string
          format: uri
        urlType:
          type: string
          enum: [ExternalUrl]

    # {"itemType": "TimelineTrend", "__typename": "TimelineTrend", "social_context": {"type": "TimelineGeneralContext", "contextType": "Facepile", "text": "18 hours ago \\u00b7 Sports \\u00b7 64K posts", "contextImageUrls": ["https://pbs.twimg.com/profile_images/1889603596309639168/KSBuQ9vL_normal.png", "https://pbs.twimg.com/profile_images/1638484441101221890/dp7HU1PB_normal.jpg", "https://pbs.twimg.com/profile_images/1605131756310614017/05qwHae-_normal.jpg"]}, "is_ai_trend": true, "name": "Manchester United Unveils Plans for \\u00a32bn Stadium with 100,000 Capacity", "trend_url": {"url": "twitter://trending/1899449402634424550", "urlType": "DeepLink"}, "trend_metadata": {"url": {"url": "twitter://trending/1899449402634424550", "urlType": "DeepLink"}}, "thumbnail_image": {"original_img_url": "https://pbs.twimg.com/media/Glv52LAXgAAzZcC.jpg", "original_img_width": 3072, "original_img_height": 4096}, "images": [{"url": "https://pbs.twimg.com/media/Glv52LAXgAAzZcC.jpg"}]}

    TimelineTrend:
      required:
        - "__typename"
        - "itemType"
        - "name"
        - "trend_url"
        - "trend_metadata"
        - "thumbnail_image"
        - "images"
      properties:
        __typename:
          $ref: "./typename.yaml#/components/schemas/TypeName" # TimelineTrend
        itemType:
          $ref: "#/components/schemas/ContentItemType" # TimelineTrend
        social_context:
          $ref: "#/components/schemas/SocialContextUnion"
        is_ai_trend:
          type: boolean
        name:
          type: string
        trend_url:
          $ref: "#/components/schemas/SocialContextLandingUrl"
        trend_metadata:
          $ref: "#/components/schemas/TrendMetadata"
        thumbnail_image:
          $ref: "#/components/schemas/ThumbnailImage"
        images:
          type: array
          items:
            $ref: "#/components/schemas/TrendImage"

    TrendMetadata:
      type: object
      properties:
        url:
          $ref: "#/components/schemas/SocialContextLandingUrl"

    ThumbnailImage:
      type: object
      properties:
        original_img_url:
          type: string
          format: uri
        original_img_width:
          type: integer
        original_img_height:
          type: integer

    TrendImage:
      type: object
      properties:
        url:
          type: string
          format: uri
